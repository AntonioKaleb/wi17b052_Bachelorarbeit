<Activity mc:Ignorable="sap sap2010" x:Class="GenerateReport" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:h="clr-namespace:HtmlToPdfConvertLibrary;assembly=HtmlToPdfConvertLibrary" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sd="clr-namespace:System.Data;assembly=System.Data" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:upap="clr-namespace:UiPath.PDF.Activities.PDF;assembly=UiPath.PDF.Activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="in_Config" Type="InArgument(scg:Dictionary(x:String, x:Object))" />
    <x:Property Name="dbConn" Type="InArgument(ui:DatabaseConnection)" />
    <x:Property Name="DEBUG_" Type="InArgument(x:Boolean)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <sap:VirtualizedContainerService.HintSize>1858,8296</sap:VirtualizedContainerService.HintSize>
  <sap2010:WorkflowViewState.IdRef>ActivityBuilder_1</sap2010:WorkflowViewState.IdRef>
  <TextExpression.NamespacesForImplementation>
    <scg:List x:TypeArguments="x:String" Capacity="29">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>UiPath.Database</x:String>
      <x:String>System.Xml.Serialization</x:String>
      <x:String>Microsoft.VisualBasic.CompilerServices</x:String>
      <x:String>System.Globalization</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Text.RegularExpressions</x:String>
      <x:String>System.Reflection</x:String>
      <x:String>System.Security</x:String>
    </scg:List>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <scg:List x:TypeArguments="AssemblyReference" Capacity="23">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>UiPath.Database</AssemblyReference>
      <AssemblyReference>System.ServiceModel</AssemblyReference>
      <AssemblyReference>UiPath.Excel</AssemblyReference>
      <AssemblyReference>UiPath.Mail</AssemblyReference>
      <AssemblyReference>System.ComponentModel.Composition</AssemblyReference>
      <AssemblyReference>System.ValueTuple</AssemblyReference>
    </scg:List>
  </TextExpression.ReferencesForImplementation>
  <Sequence sap:VirtualizedContainerService.HintSize="1838,8196" sap2010:WorkflowViewState.IdRef="Sequence_33">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
        <x:Boolean x:Key="IsPinned">False</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>
    <TryCatch DisplayName="Try Catch" sap:VirtualizedContainerService.HintSize="1796,8104" sap2010:WorkflowViewState.IdRef="TryCatch_1">
      <sap:WorkflowViewStateService.ViewState>
        <scg:Dictionary x:TypeArguments="x:String, x:Object">
          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          <x:Boolean x:Key="IsPinned">False</x:Boolean>
        </scg:Dictionary>
      </sap:WorkflowViewStateService.ViewState>
      <TryCatch.Try>
        <Sequence DisplayName="GenerateReport" sap:VirtualizedContainerService.HintSize="1758,7877" sap2010:WorkflowViewState.IdRef="Sequence_1">
          <Sequence.Variables>
            <Variable x:TypeArguments="sd:DataTable" Name="dtSB" />
            <Variable x:TypeArguments="sd:DataTable" Name="dtReport" />
            <Variable x:TypeArguments="x:String" Name="ExceptionMessage" />
            <Variable x:TypeArguments="x:String" Default="C:\\DOK_IMPORT\\1908\\" Name="DocsDokPath" />
            <Variable x:TypeArguments="ui:GenericValue" Name="ReportZeilen" />
          </Sequence.Variables>
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1716,229" sap2010:WorkflowViewState.IdRef="CommentOut_33">
            <ui:CommentOut.Body>
              <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,151" sap2010:WorkflowViewState.IdRef="Sequence_72">
                <sap:WorkflowViewStateService.ViewState>
                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                  </scg:Dictionary>
                </sap:WorkflowViewStateService.ViewState>
                <ui:DatabaseConnect DatabaseConnection="[dbConn]" DisplayName="Connect - UiPathData" sap:VirtualizedContainerService.HintSize="334,59" sap2010:WorkflowViewState.IdRef="DatabaseConnect_1" ProviderName="System.Data.SqlClient" ConnectionString="Data Source=lbg-lab\BMD;Integrated Security=True" />
              </Sequence>
            </ui:CommentOut.Body>
          </ui:CommentOut>
          <ui:CreateDirectory ContinueOnError="False" DisplayName="Create Folder " sap:VirtualizedContainerService.HintSize="1716,84" sap2010:WorkflowViewState.IdRef="CreateDirectory_1" Path="TMP" />
          <ui:ExecuteQuery ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtSB]" DisplayName="Execute Query" ExistingDbConnection="[dbConn]" sap:VirtualizedContainerService.HintSize="1716,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_1" Sql="Select Distinct Jahr,Monat,Sachbearbeiter, CAST(LEFT(Sachbearbeiter, 2) AS INT) as KanzleiNr&#xD;&#xA;From Uipathdata.dbo.[P1908.SBStatus]&#xD;&#xA;Where Jahr = YEAR(getdate()) And &#xD;&#xA;&#x9;  Monat = MONTH(getdate()) And&#xD;&#xA;&#x9;  Sachbearbeiter like '_____' and&#xD;&#xA;&#x9;  ReportGenerate = 1 and&#xD;&#xA;&#x9;   TaskGenerated is null&#x9;  &#xD;&#xA;Order By Sachbearbeiter ">
            <ui:ExecuteQuery.Parameters>
              <scg:Dictionary x:TypeArguments="x:String, Argument" />
            </ui:ExecuteQuery.Parameters>
          </ui:ExecuteQuery>
          <ui:ForEachRow CurrentIndex="{x:Null}" DataTable="[dtSB]" DisplayName="For Each Row / SB" sap:VirtualizedContainerService.HintSize="1716,7264" sap2010:WorkflowViewState.IdRef="ForEachRow_1">
            <ui:ForEachRow.Body>
              <ActivityAction x:TypeArguments="sd:DataRow">
                <ActivityAction.Argument>
                  <DelegateInArgument x:TypeArguments="sd:DataRow" Name="rowSB" />
                </ActivityAction.Argument>
                <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="1666,7116" sap2010:WorkflowViewState.IdRef="Sequence_2">
                  <Sequence.Variables>
                    <Variable x:TypeArguments="x:String" Name="tets" />
                    <Variable x:TypeArguments="x:String" Name="HTMLBody" />
                    <Variable x:TypeArguments="x:String" Name="exceptionpdfgen" />
                    <Variable x:TypeArguments="x:Int32" Name="i" />
                    <Variable x:TypeArguments="s:String[]" Name="HTMLSplit" />
                    <Variable x:TypeArguments="x:Int32" Name="j" />
                    <Variable x:TypeArguments="x:String" Name="Jahr" />
                    <Variable x:TypeArguments="x:String" Name="Monat" />
                    <Variable x:TypeArguments="ui:GenericValue" Name="Sachbearbeiter" />
                    <Variable x:TypeArguments="s:DateTime" Name="now" />
                    <Variable x:TypeArguments="x:String" Name="cssText" />
                    <Variable x:TypeArguments="x:String" Name="footerContent" />
                    <Variable x:TypeArguments="x:String" Name="headerContent" />
                    <Variable x:TypeArguments="x:String" Name="pageContent" />
                    <Variable x:TypeArguments="x:String" Name="creationDate" />
                    <Variable x:TypeArguments="x:String" Name="legendText" />
                    <Variable x:TypeArguments="x:String" Name="tableHeading" />
                    <Variable x:TypeArguments="x:String" Name="KanzleiNr" />
                    <Variable x:TypeArguments="x:String" Name="KanzleiStandardPerson" />
                    <Variable x:TypeArguments="sd:DataTable" Name="SBFullNameTable" />
                    <Variable x:TypeArguments="x:String" Name="SBFullName" />
                    <Variable x:TypeArguments="x:String" Name="HeaderJahr" />
                    <Variable x:TypeArguments="x:String" Name="HeaderMonat" />
                  </Sequence.Variables>
                  <sap:WorkflowViewStateService.ViewState>
                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                    </scg:Dictionary>
                  </sap:WorkflowViewStateService.ViewState>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_23">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[Jahr]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[rowSB.Item("Jahr").ToString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_24">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[Monat]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[rowSB.Item("Monat").toString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_25">
                    <Assign.To>
                      <OutArgument x:TypeArguments="ui:GenericValue">[Sachbearbeiter]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="ui:GenericValue">[rowSB.Item("Sachbearbeiter").ToString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_38">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[KanzleiNr]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[rowSB.Item("KanzleiNr").ToString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Switch x:TypeArguments="x:String" DisplayName="Switch- Datum Leading Zero" Expression="[Monat]" sap:VirtualizedContainerService.HintSize="1624,51" sap2010:WorkflowViewState.IdRef="Switch`1_2">
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                    <Sequence x:Key="1" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_58">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_45">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[(int32.Parse(Jahr)-1).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_46">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">12</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="2" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_59">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_43">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_42">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">01</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="3" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_60">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_47">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_48">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">02</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="4" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_61">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_49">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_50">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">03</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="5" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_62">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_51">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_52">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">04</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="6" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_63">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_53">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_54">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">05</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="7" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_64">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_55">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_56">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">06</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="8" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_65">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_57">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_58">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">07</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="9" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_66">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_59">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_60">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">08</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="10" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_67">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_61">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_62">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">09</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="11" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_68">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_63">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_64">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">10</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                    <Sequence x:Key="12" sap:VirtualizedContainerService.HintSize="304,248" sap2010:WorkflowViewState.IdRef="Sequence_69">
                      <sap:WorkflowViewStateService.ViewState>
                        <scg:Dictionary x:TypeArguments="x:String, x:Object">
                          <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        </scg:Dictionary>
                      </sap:WorkflowViewStateService.ViewState>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_65">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr).ToString]</InArgument>
                        </Assign.Value>
                      </Assign>
                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_66">
                        <Assign.To>
                          <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                        </Assign.To>
                        <Assign.Value>
                          <InArgument x:TypeArguments="x:String">11</InArgument>
                        </Assign.Value>
                      </Assign>
                    </Sequence>
                  </Switch>
                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1624,51" sap2010:WorkflowViewState.IdRef="CommentOut_31">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="591,491" sap2010:WorkflowViewState.IdRef="Sequence_70">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <If Condition="[Monat.Equals(&quot;1&quot;) or Monat.Equals(&quot;01&quot;)]" sap:VirtualizedContainerService.HintSize="549,399" sap2010:WorkflowViewState.IdRef="If_9">
                          <If.Then>
                            <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_39">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_40">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[HeaderJahr]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[int32.Parse(Jahr)-1]</InArgument>
                                </Assign.Value>
                              </Assign>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_41">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[HeaderMonat]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[12]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Sequence>
                          </If.Then>
                          <If.Else>
                            <Sequence sap:VirtualizedContainerService.HintSize="200,83" sap2010:WorkflowViewState.IdRef="Sequence_42">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                            </Sequence>
                          </If.Else>
                        </If>
                      </Sequence>
                    </ui:CommentOut.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CommentOut>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1624,91" sap2010:WorkflowViewState.IdRef="LogMessage_4" Level="Info" Message="[&quot;Start generating for Sachbearbeiter: &quot; + Sachbearbeiter]" />
                  <ui:ExecuteQuery ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[dtReport]" DisplayName="Execute Query" ExistingDbConnection="[dbConn]" sap:VirtualizedContainerService.HintSize="1624,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_2" Sql="select (select top 1 CONCAT(per_name, ' ', per_vorname) from LBG.BUERO.PER_PERSON where PER_PERSONENNR = P1908.FirmenNr and per_personenart = 'KL') as FirmenName, P1908.*&#xA;from UiPathData.dbo.P1908_GKKBK P1908&#xA;where Jahr = @Year and&#xA;&#x9;  Monat = @Month and&#xA;&#x9;  Sachbearbeiter = @Sachbearbeiter&#xA;order by ExceptionMessage asc, BeitragskontoSaldo desc&#xA;">
                    <ui:ExecuteQuery.Parameters>
                      <InArgument x:TypeArguments="x:String" x:Key="Sachbearbeiter">[rowSB.Item("Sachbearbeiter").ToString]</InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="Year">[Jahr]</InArgument>
                      <InArgument x:TypeArguments="x:String" x:Key="Month">[Monat]</InArgument>
                    </ui:ExecuteQuery.Parameters>
                  </ui:ExecuteQuery>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_37">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[tableHeading]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String" xml:space="preserve">["&lt;th width=""5%""&gt;#&lt;/th&gt;    &lt;th width =""12%""&gt;Kd-Nr.&lt;/th&gt;    &lt;th width=""""&gt;Kunde&lt;/th&gt;     &lt;th width=""14%""&gt;Beitragskonto&lt;/th&gt;	&lt;th width= ""20%""&gt;Saldo / Hinweis&lt;/th&gt;"]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_44">
                    <Assign.To>
                      <OutArgument x:TypeArguments="ui:GenericValue">[ReportZeilen]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="ui:GenericValue">[dtReport.Rows.Count.ToString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="1624,91" sap2010:WorkflowViewState.IdRef="LogMessage_10" Level="Info" Message="[&quot;ROW COUNTS: &quot; + ReportZeilen]" />
                  <ui:ForEachRow CurrentIndex="[i]" DataTable="[dtReport]" DisplayName="For Each Row" sap:VirtualizedContainerService.HintSize="1624,2656" sap2010:WorkflowViewState.IdRef="ForEachRow_2">
                    <ui:ForEachRow.Body>
                      <ActivityAction x:TypeArguments="sd:DataRow">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="sd:DataRow" Name="row" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="1574,2508" sap2010:WorkflowViewState.IdRef="Sequence_3">
                          <Sequence.Variables>
                            <Variable x:TypeArguments="x:String" Name="CSSClass" />
                            <Variable x:TypeArguments="x:String" Name="Saldo" />
                            <Variable x:TypeArguments="x:String" Name="BeitragskontoSaldo" />
                            <Variable x:TypeArguments="x:String" Name="FirmenNr" />
                            <Variable x:TypeArguments="x:String" Name="FirmenName" />
                            <Variable x:TypeArguments="x:String" Name="BeitragskontoNr" />
                          </Sequence.Variables>
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <Assign sap:VirtualizedContainerService.HintSize="1532,60" sap2010:WorkflowViewState.IdRef="Assign_13">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[ExceptionMessage]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">
                                <Literal x:TypeArguments="x:String" Value="" />
                              </InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="1532,60" sap2010:WorkflowViewState.IdRef="Assign_18">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[ExceptionMessage]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[row("ExceptionMessage").ToString]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="1532,60" sap2010:WorkflowViewState.IdRef="Assign_19">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[BeitragskontoSaldo]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[row("BeitragskontoSaldo").ToString]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="1532,60" sap2010:WorkflowViewState.IdRef="Assign_20">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[FirmenNr]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[row("FirmenNr").ToString]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="1532,60" sap2010:WorkflowViewState.IdRef="Assign_21">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[FirmenName]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[row("FirmenName").ToString]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <Assign sap:VirtualizedContainerService.HintSize="1532,60" sap2010:WorkflowViewState.IdRef="Assign_22">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[BeitragskontoNr]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String">[row("BeitragskontoNr").ToString]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <If sap2010:Annotation.AnnotationText="###TODO### &#xA;REWORK" Condition="[String.IsNullOrEmpty(ExceptionMessage) = false]" sap:VirtualizedContainerService.HintSize="1532,694" sap2010:WorkflowViewState.IdRef="If_2">
                            <sap:WorkflowViewStateService.ViewState>
                              <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
                                <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                <x:Boolean x:Key="IsPinned">False</x:Boolean>
                              </scg:Dictionary>
                            </sap:WorkflowViewStateService.ViewState>
                            <If.Then>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_4">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[CSSClass]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">SaldoError</InArgument>
                                </Assign.Value>
                              </Assign>
                            </If.Then>
                            <If.Else>
                              <If Condition="[String.IsNullOrEmpty(BeitragskontoSaldo)]" sap:VirtualizedContainerService.HintSize="1225,504" sap2010:WorkflowViewState.IdRef="If_5">
                                <If.Then>
                                  <Sequence sap:VirtualizedContainerService.HintSize="304,252" sap2010:WorkflowViewState.IdRef="Sequence_5">
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_11">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[CSSClass]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">SaldoError</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_12">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[ExceptionMessage]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">###Noch nicht ausgelesen###</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                  </Sequence>
                                </If.Then>
                                <If.Else>
                                  <If Condition="[BeitragskontoSaldo = &quot;0.0000&quot;]" sap:VirtualizedContainerService.HintSize="876,356" sap2010:WorkflowViewState.IdRef="If_1">
                                    <If.Then>
                                      <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_5">
                                        <Assign.To>
                                          <OutArgument x:TypeArguments="x:String">[CSSClass]</OutArgument>
                                        </Assign.To>
                                        <Assign.Value>
                                          <InArgument x:TypeArguments="x:String">SaldoNeutral</InArgument>
                                        </Assign.Value>
                                      </Assign>
                                    </If.Then>
                                    <If.Else>
                                      <If Condition="[BeitragskontoSaldo.Contains(&quot;-&quot;)]" sap:VirtualizedContainerService.HintSize="569,208" sap2010:WorkflowViewState.IdRef="If_3">
                                        <If.Then>
                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_6">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[CSSClass]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">SaldoGuthaben</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Then>
                                        <If.Else>
                                          <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_7">
                                            <Assign.To>
                                              <OutArgument x:TypeArguments="x:String">[CSSClass]</OutArgument>
                                            </Assign.To>
                                            <Assign.Value>
                                              <InArgument x:TypeArguments="x:String">SaldoRueckstand</InArgument>
                                            </Assign.Value>
                                          </Assign>
                                        </If.Else>
                                      </If>
                                    </If.Else>
                                  </If>
                                </If.Else>
                              </If>
                            </If.Else>
                          </If>
                          <Switch x:TypeArguments="x:String" DisplayName="Switch" Expression="[ExceptionMessage]" sap:VirtualizedContainerService.HintSize="1532,338" sap2010:WorkflowViewState.IdRef="Switch`1_1">
                            <Switch.Default>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_36">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[ExceptionMessage]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">Fehler</InArgument>
                                </Assign.Value>
                              </Assign>
                            </Switch.Default>
                            <Assign x:Key="Das Konto wurde bereits beendet." sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_33">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[ExceptionMessage]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String" xml:space="preserve"> | BK-E</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Assign x:Key="Es wurden keine Beitragskonten gefunden." sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_34">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[ExceptionMessage]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">BK-F</InArgument>
                              </Assign.Value>
                            </Assign>
                            <Assign x:Key="KeinMandantenarchiv" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_35">
                              <Assign.To>
                                <OutArgument x:TypeArguments="x:String">[ExceptionMessage]</OutArgument>
                              </Assign.To>
                              <Assign.Value>
                                <InArgument x:TypeArguments="x:String">Fehler</InArgument>
                              </Assign.Value>
                            </Assign>
                            <x:Null x:Key="" />
                            <x:Null x:Key="{x:Null}" />
                          </Switch>
                          <If Condition="[String.IsNullOrEmpty(BeitragskontoSaldo)]" sap:VirtualizedContainerService.HintSize="1532,208" sap2010:WorkflowViewState.IdRef="If_4">
                            <If.Then>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_9">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[saldo]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">
                                    <Literal x:TypeArguments="x:String" Value="" />
                                  </InArgument>
                                </Assign.Value>
                              </Assign>
                            </If.Then>
                            <If.Else>
                              <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_8">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[saldo]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[System.Convert.ToDouble(row("BeitragskontoSaldo")).ToString("C",System.Globalization.CultureInfo.GetCultureInfo("de-DE"))]</InArgument>
                                </Assign.Value>
                              </Assign>
                            </If.Else>
                          </If>
                          <Assign sap:VirtualizedContainerService.HintSize="1532,60" sap2010:WorkflowViewState.IdRef="Assign_2">
                            <Assign.To>
                              <OutArgument x:TypeArguments="x:String">[HTMLBody]</OutArgument>
                            </Assign.To>
                            <Assign.Value>
                              <InArgument x:TypeArguments="x:String" xml:space="preserve">[HTMLBody + "&lt;tr class="""+CSSClass+"""&gt;&lt;td class=""ID""&gt;"+(i+1).ToString+"&lt;/td&gt;&lt;td class=""Firmennummer""&gt;"+FirmenNr+"&lt;/td&gt;	&lt;td class=""Name""&gt;"+FirmenName+"&lt;/td&gt; 	&lt;td class=""BeitragskontoNr""&gt;"+BeitragskontoNr+"&lt;/td&gt;	&lt;td class=""Saldo""&gt;"+Saldo+ExceptionMessage+"&lt;/td&gt;&lt;/tr&gt;"]</InArgument>
                            </Assign.Value>
                          </Assign>
                          <If Condition="[(i+1) = ReportZeilen]" sap:VirtualizedContainerService.HintSize="1532,356" sap2010:WorkflowViewState.IdRef="If_10">
                            <If.Else>
                              <If Condition="[(i+1) mod 28 = 0]" sap:VirtualizedContainerService.HintSize="484,208" sap2010:WorkflowViewState.IdRef="If_6">
                                <If.Then>
                                  <Assign sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_14">
                                    <Assign.To>
                                      <OutArgument x:TypeArguments="x:String">[HTMLBody]</OutArgument>
                                    </Assign.To>
                                    <Assign.Value>
                                      <InArgument x:TypeArguments="x:String">[HTMLBody + "***"]</InArgument>
                                    </Assign.Value>
                                  </Assign>
                                </If.Then>
                              </If>
                            </If.Else>
                          </If>
                        </Sequence>
                      </ActivityAction>
                    </ui:ForEachRow.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:ForEachRow>
                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1624,51" sap2010:WorkflowViewState.IdRef="CommentOut_7">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,224" sap2010:WorkflowViewState.IdRef="Sequence_30">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:WriteTextFile DisplayName="Write Text File" FileName="[&quot;C:\1908TEMP\MRTmp\htmlbodydump&quot;+Sachbearbeiter+&quot;.txt&quot;]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="WriteTextFile_1" Text="[HTMLBody]" />
                      </Sequence>
                    </ui:CommentOut.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CommentOut>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_15">
                    <Assign.To>
                      <OutArgument x:TypeArguments="s:String[]">[HTMLSplit]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="s:String[]">[system.text.RegularExpressions.Regex.Split(htmlbody,"\*\*\*").ToArray]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="1624,51" sap2010:WorkflowViewState.IdRef="CommentOut_8">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="454,451" sap2010:WorkflowViewState.IdRef="Sequence_31">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="412,357" sap2010:WorkflowViewState.IdRef="ForEach`1_4" Values="[HTMLSplit]">
                          <ui:ForEach.Body>
                            <ActivityAction x:TypeArguments="x:String">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="x:String" Name="item" />
                              </ActivityAction.Argument>
                              <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="376,224" sap2010:WorkflowViewState.IdRef="Sequence_26">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <ui:AppendLine DisplayName="Append Line" FileName="[&quot;C:\1908TEMP\MRTmp\htmlsplitdump&quot;+Sachbearbeiter+&quot;.txt&quot;]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendLine_5" Text="[item + &quot;######&quot;]" />
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEach.Body>
                        </ui:ForEach>
                      </Sequence>
                    </ui:CommentOut.Body>
                    <sap:WorkflowViewStateService.ViewState>
                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                        <x:Boolean x:Key="IsExpanded">False</x:Boolean>
                        <x:Boolean x:Key="IsPinned">False</x:Boolean>
                      </scg:Dictionary>
                    </sap:WorkflowViewStateService.ViewState>
                  </ui:CommentOut>
                  <ui:CommentOut DisplayName="Comment Out - Debugging, count pages" sap:VirtualizedContainerService.HintSize="1624,261" sap2010:WorkflowViewState.IdRef="CommentOut_13">
                    <ui:CommentOut.Body>
                      <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,183" sap2010:WorkflowViewState.IdRef="Sequence_38">
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_6" Level="Info" Message="[&quot;SplitCount = &quot; + HTMLSplit.Count.ToString]" />
                      </Sequence>
                    </ui:CommentOut.Body>
                  </ui:CommentOut>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,64" sap2010:WorkflowViewState.IdRef="Assign_26">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[cssText]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String" xml:space="preserve">
body {
font-family: Times New Roman;
font-size: 11pt;
}

table, th, td {
    font-family: Times New Roman;
	/*font-size: 11pt;*/
    border-collapse: collapse;
    border: 1px LightGray;
	border-bottom: 1px solid LightGray;
	padding: 3px;


} 


tr:nth-child(even) {
	background-color: #f2f2f2;
} 

table {
    width:525px; 
	max-width:525px;
	}
	
	
h1{
font-size: 18px;
margin-top:0px;
margin-bottom:0px;
}

h2{
margin-top:0px;
margin-bottom:5px;
font-size:14px;
font-style: italic;
}

h3 {
margin-top:0px;
padding-bottom:50px;
font-size: 10pt;
}

.legendText {
     font-size: 1px;
    /*font-style: italic;*/
    margin-top: 10px;
	border: 1px solid LightGray;
	width:525px; 
	max-width:525px;
	/*padding:0px;*/
}

.legendText table {
    border: none;
}

.legendText tr {
	border-bottom: 1px solid LightGray;
	padding-top: 3px;
}

.legendText td {
    vertical-align: top;
    text-align: left;
    border: 0px 0px 1px 0px;
	padding:1px;
}


.ID {

	text-align: center;
}	
.Firmennummer {

	text-align: center;
}	
.Name {
	white-space: nowrap;
	text-align: left;
	
}	
.BeitragskontoNr {

	text-align: left;
	padding-left:8px;
}	
	
.SaldoGuthaben .Saldo {
	background-color: #adebad !important;
	//background-image: linear-gradient(To right, red , yellow);
	text-align:right;
		//background-clip: padding-box !important;
		//background-origin: content-box !important;
		//background-size: contain !important;
		//padding-right: 0px;
}

.SaldoRueckstand .Saldo {
	background-color:  #ffb3b3 !important;
	text-align: right;
	//margin-left: 0px;
	//color: green !important;
	//	background-clip: padding-box !important;
	//	background-origin: content-box;
	//	background-size: contain;
}




.SaldoNeutral {
	text-align: right;
}



.SaldoError .Saldo {
	//color: #ff8080 !important;
	//font-weight: bold;
	background-color:  #e6e6e6 !important;
	//	background-clip: padding-box !important;
		text-align: right;
	
}
</InArgument>
                    </Assign.Value>
                  </Assign>
                  <ui:ExecuteQuery ContinueOnError="{x:Null}" TimeoutMS="{x:Null}" CommandType="Text" DataTable="[SBFullNameTable]" DisplayName="Execute Query" ExistingDbConnection="[dbConn]" sap:VirtualizedContainerService.HintSize="1624,88" sap2010:WorkflowViewState.IdRef="ExecuteQuery_3" Sql="select top 1 concat(PER_NAME,' ',PER_VORNAME) as MA_NAME&#xA;from LBG.buero.PER_PERSON&#xA;where PER_FIRMENNR = 11 and &#xA;        PER_PERSONENART = 'MA' and &#xA;             PER_PERSONENID = CONCAT('MA2000', @Sachbearbeiter)&#xA;">
                    <ui:ExecuteQuery.Parameters>
                      <InArgument x:TypeArguments="x:String" x:Key="Sachbearbeiter">[Sachbearbeiter]</InArgument>
                    </ui:ExecuteQuery.Parameters>
                  </ui:ExecuteQuery>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_39">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[SBFullName]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[SBFullNameTable.Rows(0)(0).ToString]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_28">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[headerContent]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String" xml:space="preserve">["&lt;table style=""margin: 9px;""&gt; &lt;tr&gt;&lt;th style=""text-align: left; border-color: white;""&gt;&lt;h1&gt;ÖGK-Beitragskonten-Report für  "+HeaderJahr.ToString+"/"+HeaderMonat.ToString+"&lt;br&gt;PersonalverrechnerIn:  " + Sachbearbeiter.ToString + " " + SBFullName + "&lt;/h1&gt;&lt;/th&gt;&lt;th style=""text-align: right; border-color: white;""&gt;&lt;img src=""Data\lbgoelogo.png"" width=""170px"", height=""58px""&gt;&lt;/tr&gt;&lt;/th&gt;&lt;/table&gt;"]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_31">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[creationDate]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">[DateTime.Now.ToString("dd.MM.yyyy | HH:mm")]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,64" sap2010:WorkflowViewState.IdRef="Assign_32">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[legendText]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String" xml:space="preserve">["&lt;div style=""font-size:8pt; margin-top: 3px;""&gt;&lt;a href=""http://lbg-app3/faq/PV/""&gt;Alle Informationen zum DA-Prozess ""ÖGK-Beitragskonten"" finden Sie in den ""PV FAQs"".&lt;/a&gt;&lt;font color =""red""&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Rückstand&lt;/font&gt; &lt;font color =""green""&gt;Guthaben&lt;/font&gt;&lt;/div&gt;&lt;div class=""legendText""&gt;&lt;h2&gt;&amp;nbsp;Hinweise zu fehlerhaften Abrufen von Beitragskonten (BK). &lt;/h2&gt; &lt;table style=""white-space:normal !important; font-size: 9pt;""&gt;"+
"&lt;tr&gt;&lt;td style=""padding-right:10px;""&gt;BK-F&lt;/td&gt; &lt;td&gt;BK-Vollmacht im WEBEKU nicht gesetzt oder BK-Nummer in BMD-Lohnfirma fehlerhaft hinterlegt. Bitte BK-Vollmacht im WEBEKU setzen oder BK-Nummer in BMD-Lohnfirma prüfen;&lt;/td&gt;&lt;/tr&gt;"+
"&lt;tr&gt;&lt;td&gt;BK-E&lt;/td&gt;&lt;td&gt;Aktuell kein Dienstnehmer für dieses BK angemeldet;&lt;/td&gt;&lt;/tr&gt;"+
"&lt;tr&gt;&lt;td&gt;Fehler&lt;/td&gt;&lt;td&gt;Beim Abrufen des BK ist ein Fehler aufgetreten (z.B.: WEBEKU nicht erreichbar, etc.). Bitte Saldo dieses BK manuell prüfen;&lt;/td&gt;&lt;/tr&gt;"+
"&lt;/table&gt;&lt;/div&gt;"]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <Assign sap:VirtualizedContainerService.HintSize="1624,60" sap2010:WorkflowViewState.IdRef="Assign_27">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[footerContent]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String" xml:space="preserve">["&lt;table&gt; &lt;tr&gt;&lt;td style=""text-align: left; font-size: 13px; border-color: white; width: 32%;""&gt;Ersteller: DA&lt;/td&gt;&lt;td style=""text-align: center; font-size: 13px;  border-color: white; width=25%;""&gt;Stand: " + creationDate + "&lt;/td&gt;&lt;td style=""text-align: right; font-size: 13px;  border-color: white; width=40%;""&gt;   "]</InArgument>
                    </Assign.Value>
                  </Assign>
                  <If Condition="[HTMLSplit.Count  &lt;= 1]" sap:VirtualizedContainerService.HintSize="1624,1377" sap2010:WorkflowViewState.IdRef="If_8">
                    <If.Then>
                      <Sequence sap:VirtualizedContainerService.HintSize="478,800" sap2010:WorkflowViewState.IdRef="Sequence_21">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="x:String" Name="variable2" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Assign sap:VirtualizedContainerService.HintSize="436,60" sap2010:WorkflowViewState.IdRef="Assign_29">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[pageContent]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">Seite 1/1 &lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;</InArgument>
                          </Assign.Value>
                        </Assign>
                        <h:HtmlToPdfConvert HeaderXPositionPx="{x:Null}" HeaderYPositionPx="{x:Null}" Result="{x:Null}" Body="[&quot;&lt;table style=&quot;&quot;font-size: 11pt;&quot;&quot;&gt;&lt;tr&gt;  &quot;+tableHeading+&quot;&lt;/tr&gt;&quot; + HTMLBody + &quot;&lt;/table&gt;&quot; + legendText]" DirectoryPath="[DocsDokPath+Jahr+&quot;_&quot;+Monat+&quot;_&quot;+Sachbearbeiter +&quot;.pdf&quot;]" DisplayName="Html to pdf convert" Exception="[exceptionpdfgen]" FooterXPositionPx="32" FooterYPositionPx="780" sap:VirtualizedContainerService.HintSize="436,135" HtmlCustomStyles="[cssText]" HtmlFooterContent="[footerContent + pageContent]" HtmlHeaderContent="[headerContent]" sap2010:WorkflowViewState.IdRef="HtmlToPdfConvert_2" MarginBottomPdf="40" MarginLeftPdf="30" MarginRightPdf="30" MarginTopPdf="40" PageSizePdf="A4" />
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="436,91" sap2010:WorkflowViewState.IdRef="LogMessage_8" Level="Info" Message="[&quot;Report for SB [&quot; + Sachbearbeiter + &quot;] generated.&quot;]" />
                        <ui:CommentOut DisplayName="Comment Out" sap:VirtualizedContainerService.HintSize="436,302" sap2010:WorkflowViewState.IdRef="CommentOut_10">
                          <ui:CommentOut.Body>
                            <Sequence DisplayName="Ignored Activities" sap:VirtualizedContainerService.HintSize="376,224" sap2010:WorkflowViewState.IdRef="Sequence_35">
                              <sap:WorkflowViewStateService.ViewState>
                                <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                  <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                </scg:Dictionary>
                              </sap:WorkflowViewStateService.ViewState>
                              <ui:AppendLine DisplayName="Append Line" FileName="[DebugHtml.txt&quot;]" sap:VirtualizedContainerService.HintSize="334,132" sap2010:WorkflowViewState.IdRef="AppendLine_4" Text="[HTMLBody + &quot;&lt;/table&gt;&quot; + legendText]" />
                            </Sequence>
                          </ui:CommentOut.Body>
                        </ui:CommentOut>
                      </Sequence>
                    </If.Then>
                    <If.Else>
                      <Sequence sap:VirtualizedContainerService.HintSize="520,1229" sap2010:WorkflowViewState.IdRef="Sequence_11">
                        <Sequence.Variables>
                          <Variable x:TypeArguments="scg:ICollection(x:String)" Name="collPages" />
                        </Sequence.Variables>
                        <sap:WorkflowViewStateService.ViewState>
                          <scg:Dictionary x:TypeArguments="x:String, x:Object">
                            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                          </scg:Dictionary>
                        </sap:WorkflowViewStateService.ViewState>
                        <Assign sap:VirtualizedContainerService.HintSize="478,60" sap2010:WorkflowViewState.IdRef="Assign_17">
                          <Assign.To>
                            <OutArgument x:TypeArguments="scg:ICollection(x:String)">[collPages]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="scg:ICollection(x:String)">[new Collection(of string)]</InArgument>
                          </Assign.Value>
                        </Assign>
                        <ui:ForEach x:TypeArguments="x:String" CurrentIndex="[j]" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="478,807" sap2010:WorkflowViewState.IdRef="ForEach`1_2" Values="[HTMLsplit]">
                          <ui:ForEach.Body>
                            <ActivityAction x:TypeArguments="x:String">
                              <ActivityAction.Argument>
                                <DelegateInArgument x:TypeArguments="x:String" Name="page" />
                              </ActivityAction.Argument>
                              <Sequence sap:VirtualizedContainerService.HintSize="442,673" sap2010:WorkflowViewState.IdRef="Sequence_10">
                                <sap:WorkflowViewStateService.ViewState>
                                  <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                    <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                  </scg:Dictionary>
                                </sap:WorkflowViewStateService.ViewState>
                                <Assign sap:VirtualizedContainerService.HintSize="400,60" sap2010:WorkflowViewState.IdRef="Assign_30">
                                  <Assign.To>
                                    <OutArgument x:TypeArguments="x:String">[pageContent]</OutArgument>
                                  </Assign.To>
                                  <Assign.Value>
                                    <InArgument x:TypeArguments="x:String">["Seite " + (j + 1).ToString + " von " + HTMLSplit.Count.ToString + "&lt;/th&gt;&lt;/tr&gt;&lt;/table&gt;"]</InArgument>
                                  </Assign.Value>
                                </Assign>
                                <Sequence sap:VirtualizedContainerService.HintSize="400,481" sap2010:WorkflowViewState.IdRef="Sequence_9">
                                  <sap:WorkflowViewStateService.ViewState>
                                    <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                      <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                    </scg:Dictionary>
                                  </sap:WorkflowViewStateService.ViewState>
                                  <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="358,389" sap2010:WorkflowViewState.IdRef="Sequence_6">
                                    <Sequence.Variables>
                                      <Variable x:TypeArguments="x:String" Name="pageformat" />
                                    </Sequence.Variables>
                                    <sap:WorkflowViewStateService.ViewState>
                                      <scg:Dictionary x:TypeArguments="x:String, x:Object">
                                        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                                      </scg:Dictionary>
                                    </sap:WorkflowViewStateService.ViewState>
                                    <Assign sap:VirtualizedContainerService.HintSize="316,60" sap2010:WorkflowViewState.IdRef="Assign_16">
                                      <Assign.To>
                                        <OutArgument x:TypeArguments="x:String">[pageformat]</OutArgument>
                                      </Assign.To>
                                      <Assign.Value>
                                        <InArgument x:TypeArguments="x:String">["&lt;table style=""font-size: 11pt;""&gt;&lt;tr&gt;"+tableHeading+"&lt;/tr&gt;" + page + "&lt;/table&gt;" +legendText]</InArgument>
                                      </Assign.Value>
                                    </Assign>
                                    <h:HtmlToPdfConvert HeaderXPositionPx="{x:Null}" HeaderYPositionPx="{x:Null}" Result="{x:Null}" Body="[pageformat]" DirectoryPath="[&quot;TMP\&quot;+j.ToString+&quot;.pdf&quot;]" DisplayName="Html to pdf convert" Exception="[exceptionpdfgen]" FooterXPositionPx="32" FooterYPositionPx="780" sap:VirtualizedContainerService.HintSize="316,135" HtmlCustomStyles="[cssText]" HtmlFooterContent="[footerContent + pageContent]" HtmlHeaderContent="[headerContent]" sap2010:WorkflowViewState.IdRef="HtmlToPdfConvert_1" MarginBottomPdf="40" MarginLeftPdf="30" MarginRightPdf="30" MarginTopPdf="40" PageSizePdf="A4" />
                                    <AddToCollection x:TypeArguments="x:String" Collection="[collPages]" DisplayName="Add To Collection" sap:VirtualizedContainerService.HintSize="316,22" sap2010:WorkflowViewState.IdRef="AddToCollection`1_1" Item="[&quot;TMP\&quot;+j.ToString+&quot;.pdf&quot;]" />
                                  </Sequence>
                                </Sequence>
                              </Sequence>
                            </ActivityAction>
                          </ui:ForEach.Body>
                        </ui:ForEach>
                        <upap:JoinPDF DisplayName="Join PDF Files" FileList="[collPages.ToArray]" sap:VirtualizedContainerService.HintSize="478,59" sap2010:WorkflowViewState.IdRef="JoinPDF_1" OutputFileName="[DocsDokPath+Jahr+&quot;_&quot;+Monat+&quot;_&quot;+Sachbearbeiter +&quot;.pdf&quot;]" />
                        <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="478,91" sap2010:WorkflowViewState.IdRef="LogMessage_9" Level="Info" Message="[&quot;Report for SB [&quot; + Sachbearbeiter + &quot;] generated.&quot;]" />
                      </Sequence>
                    </If.Else>
                  </If>
                  <ui:AppendLine DisplayName="Append Line" FileName="[DocsDokPath +  &quot;bmddocs.dok&quot;]" sap:VirtualizedContainerService.HintSize="1624,132" sap2010:WorkflowViewState.IdRef="AppendLine_6" Text="[&quot;10;&quot;+KanzleiNr+&quot;299999;;4-PV-M-Out;&quot;+DocsDokPath+rowSB.Item(&quot;Jahr&quot;).ToString+ &quot;_&quot; +rowSB.Item(&quot;Monat&quot;).ToString + &quot;_&quot; +rowSB.Item(&quot;Sachbearbeiter&quot;).ToString+ &quot;.pdf; OEGK Monatsreport &quot; +datetime.Now.AddMonths(-1).ToString(&quot;MMMM&quot;,new system.Globalization.CultureInfo(&quot;de-DE&quot;))+ &quot; - &quot; + Sachbearbeiter.toString+&quot;;;;;;&quot; + DateTime.Now.ToString(&quot;yyyyMMdd&quot;) + &quot;$EOD$DOKJAHR=&quot; + datetime.Now.Year.ToString + &quot;$EOD$DOCSMONAT=&quot; + datetime.Now.Month.ToString + &quot;$EOD$&quot;]" />
                  <ui:ForEach x:TypeArguments="x:String" CurrentIndex="{x:Null}" DisplayName="For Each" sap:VirtualizedContainerService.HintSize="1624,248" sap2010:WorkflowViewState.IdRef="ForEach`1_3" Values="[Directory.GetFiles(&quot;TMP\&quot;)]">
                    <ui:ForEach.Body>
                      <ActivityAction x:TypeArguments="x:String">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="x:String" Name="file" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="Body" sap:VirtualizedContainerService.HintSize="242,114" sap2010:WorkflowViewState.IdRef="Sequence_12">
                          <sap:WorkflowViewStateService.ViewState>
                            <scg:Dictionary x:TypeArguments="x:String, x:Object">
                              <x:Boolean x:Key="IsExpanded">True</x:Boolean>
                            </scg:Dictionary>
                          </sap:WorkflowViewStateService.ViewState>
                          <ui:Delete ContinueOnError="{x:Null}" sap:VirtualizedContainerService.HintSize="200,22" sap2010:WorkflowViewState.IdRef="Delete_1" Path="[file]" />
                        </Sequence>
                      </ActivityAction>
                    </ui:ForEach.Body>
                  </ui:ForEach>
                </Sequence>
              </ActivityAction>
            </ui:ForEachRow.Body>
          </ui:ForEachRow>
        </Sequence>
      </TryCatch.Try>
      <TryCatch.Catches>
        <Catch x:TypeArguments="s:Exception" sap:VirtualizedContainerService.HintSize="1762,21" sap2010:WorkflowViewState.IdRef="Catch`1_1">
          <sap:WorkflowViewStateService.ViewState>
            <scg:Dictionary x:TypeArguments="x:String, x:Object">
              <x:Boolean x:Key="IsExpanded">False</x:Boolean>
              <x:Boolean x:Key="IsPinned">False</x:Boolean>
            </scg:Dictionary>
          </sap:WorkflowViewStateService.ViewState>
          <ActivityAction x:TypeArguments="s:Exception">
            <ActivityAction.Argument>
              <DelegateInArgument x:TypeArguments="s:Exception" Name="exception" />
            </ActivityAction.Argument>
            <ui:LogMessage DisplayName="Log Message" sap:VirtualizedContainerService.HintSize="334,91" sap2010:WorkflowViewState.IdRef="LogMessage_7" Level="Error" Message="[&quot;GenRep Error: &quot; + exception.Message]" />
          </ActivityAction>
        </Catch>
      </TryCatch.Catches>
      <TryCatch.Finally>
        <ui:InvokeWorkflowFile ContinueOnError="{x:Null}" DisplayName="Invoke Workflow File" sap:VirtualizedContainerService.HintSize="334,87" sap2010:WorkflowViewState.IdRef="InvokeWorkflowFile_1" UnSafe="False" WorkflowFileName="StartImportMakro.xaml">
          <ui:InvokeWorkflowFile.Arguments>
            <InArgument x:TypeArguments="x:Boolean" x:Key="DEBUG_">[DEBUG_]</InArgument>
          </ui:InvokeWorkflowFile.Arguments>
        </ui:InvokeWorkflowFile>
      </TryCatch.Finally>
    </TryCatch>
  </Sequence>
</Activity>